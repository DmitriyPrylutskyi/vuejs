<!doctype html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/font-awesome.min.css">
  <link href="css/styles.css" rel="stylesheet">
  <script src="js/vue.js"></script>
</head>
<style>
.novalid {
  color: red;
}

.valid {
  color: green;
}
</style>

<body>
  <div class="wrapper">
    <div class="sample">
      <div v-if="!formSubmited">
        <form @submit.prevent="submited()">
          <div class="progress">
            <div class="progress-bar" :style="[width]"></div>
          </div>
          <app-input v-for="(item, index) in info" :key="index" :name="item.name" :value="item.value" :pattern="item.pattern" @changeInput="changeinput(index, $event)">
          </app-input>
          <button class="btn btn-primary" :class="[activate]">
            Send Data
          </button>
        </form>
      </div>
      <div v-else>
        <table class="table table-bordered ">
          <tr v-for="(item, index) in info ">
            <td>{{ item.name }}</td>
            <td>{{ item.value }}</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
  <script>
  Vue.component('app-input', {
    props: ['name', 'value', 'pattern'],
    template: `
        <div class="form-group ">
            <label>{{ name }}</label> <i v-show="!value==''" :class="validClass" aria-hidden="true "></i>
            <input type="text " class="form-control " :value="value" @input="onInput">
          </div>
      `,
    data() {
      return {

      }
    },
    computed: {
      validClass() {
        return (this.pattern.test(this.value)) ? ['fa fa-check-circle', 'valid'] : ['fa fa-info-circle', 'novalid'];
      }
    },
    methods: {
      onInput(e) {
        this.$emit('changeinput', {
          value: e.target.value,
          valid: this.pattern.test(e.target.value)
        });
      }
    }
  });

  new Vue({
    el: '.sample',
    data: {
      info: [{
          name: 'Name',
          value: '',
          pattern: /^[a-zA-Z ]{2,30}$/
        },
        {
          name: 'Phone',
          value: '',
          pattern: /^[0-9]{7,14}$/
        },
        {
          name: 'Email',
          value: '',
          pattern: /^([a-z0-9_\.-]+)@([a-z0-9_\.-]+)\.([a-z\.]{2,6})$/
        },
        {
          name: 'Some Field 1',
          value: '',
          pattern: /.+/
        },
        {
          name: 'Some Field 2',
          value: '',
          pattern: /.+/
        }
      ],
      complete: 0,
      formValid: false,
      formSubmited: false
    },
    beforeMount() {
      for (var i = 0; i < this.info.length; i++) {
        this.info[i]['valid'] = false;
      }
    },
    methods: {
      changeinput(i, data) {
        this.complete = 0;
        this.info[i].value = data.value;
        this.info[i].valid = data.valid;
        for (var i = 0; i < this.info.length; i++) {
          if (this.info[i].valid) {
            this.complete += 20;
          }
        }
        if (this.complete == 100) this.formValid = true;
      },
      submited() {
        this.formSubmited = true;
      }
    },
    computed: {
      width() {
        return {
          width: this.complete + '%'
        };
      },
      activate() {
        let disabled;
        !this.formValid ? disabled = ['disabled'] : disabled = [''];
        return disabled;
      }
    }
  });
  </script>
</body>

</html>